(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8c820e32"],{"0892":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Button",{staticClass:"mybutton",attrs:{type:"primary"},on:{click:t.addRole}},[t._v("新增类型")]),a("Input",{staticClass:"search",attrs:{search:"",placeholder:"请输入名称"},on:{"on-search":t.mysearch},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}},[a("Icon",{attrs:{slot:"suffix",type:"ios-search"},slot:"suffix"})],1),a("Table",{attrs:{border:"",data:t.tableData1,columns:t.tableColumns1}}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:t.total,current:t.currentPage},on:{"on-change":t.changePage}})],1)]),a("Modal",{attrs:{title:t.title,width:"535px"},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[a("Form",{ref:"formCustom",attrs:{model:t.formCustom,rules:t.ruleCustom,"label-width":80}},[a("FormItem",{attrs:{label:"名称",prop:"identity_name"}},[a("Input",{attrs:{type:"text"},model:{value:t.formCustom.identity_name,callback:function(e){t.$set(t.formCustom,"identity_name",e)},expression:"formCustom.identity_name"}})],1),a("FormItem",{attrs:{label:"权限",prop:"description"}},[a("Transfer",{attrs:{data:t.menuList,"target-keys":t.targetKeys1,"render-format":t.render1},on:{"on-change":t.handleChange1}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text",size:"large"},on:{click:t.cancel}},[t._v("取消")]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:t.ok}},[t._v("确定")])],1)],1)],1)},s=[],o=(a("28a5"),a("ac6a"),a("75c5"));function r(t,e){var a={pageSize:t,currentPage:e};return Object(o["a"])({url:"/getIdentitysWithPage",method:"post",data:a,withCredentials:!0})}function i(t){return Object(o["a"])({url:"/addIdentity",method:"post",data:t,withCredentials:!0})}function l(t){return Object(o["a"])({url:"/deleteIdentity",method:"post",data:t,withCredentials:!0})}function u(t){return Object(o["a"])({url:"/updateIdentity",method:"post",data:t,withCredentials:!0})}function c(t){return Object(o["a"])({url:"/searchIdentity",method:"post",data:t,withCredentials:!0})}var d=a("21b0"),m={data:function(){var t=this,e=function(t,e,a){""===e?a(new Error("请输入角色名称")):a()},a=function(t,e,a){""===e?a(new Error("请选择角色权限")):a()};return{formCustom:{identity_name:"",access:""},title:"",tomethod:"",searchValue:"",ruleCustom:{identity_name:[{validator:e,trigger:"blur"}],access:[{validator:a,trigger:"blur"}]},modal:!1,pageSize:10,total:0,currentPage:1,tableData1:[],tableColumns1:[{title:"角色名称",key:"identity_name"},{title:"权限",key:"access"},{title:"操作",key:"action",width:150,align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.show(a.index)}}},"编辑"),e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.remove(a.index)}}},"删除")])}}],menuList:[],targetKeys1:[]}},methods:{render1:function(t){return t.label},handleChange1:function(t,e,a){this.targetKeys1=t},changePage:function(t){var e=this;r(10,t).then(function(t){var a=t.data.page;"200"===t.data.resultCode?(e.tableData1=[],a.list.forEach(function(t){e.tableData1.push(t)}),e.total=a.total,e.currentPage=a.pageNum):400===t.data.resultCode&&e.$Message.info(t.data.message)})},show:function(t){var e=this.tableData1[t];this.formCustom.identity_name=e.identity_name;var a=e.access.substring(1,e.access.length-1).split(","),n=this.menuList.filter(function(t){for(var e=!1,n=0;n<a.length;n++)JSON.stringify(t.key)===a[n]&&(e=!0);return e}).map(function(t){return t.key});this.targetKeys1=n,this.formCustom.identity_id=e.identity_id,this.title="角色信息编辑",this.tomethod="update",this.modal=!0},remove:function(t){var e=this;l(this.tableData1[t].identity_id).then(function(t){200===t.data.resultCode?(e.$Message.info(t.data.message),e.changePage(e.currentPage)):400===t.data.resultCode?e.$Message.info(t.data.message):e.$Message.info("删除类型失败")})},ok:function(){var t=this;this.$refs["formCustom"].validate(function(e){e&&("update"===t.tomethod?(t.formCustom.access=JSON.stringify(t.targetKeys1),u(t.formCustom).then(function(e){t.$Message.info(e.data.message),t.changePage(t.currentPage)})):"add"===t.tomethod&&(t.formCustom.access=JSON.stringify(t.targetKeys1),i(t.formCustom).then(function(e){t.$Message.info(e.data.message),t.changePage(t.currentPage)})),t.modal=!1)})},cancel:function(){this.modal=!1},addRole:function(){this.modal=!0,this.formCustom.identity_name="",this.formCustom.access="",this.title="新增角色",this.tomethod="add"},mysearch:function(){var t=this;c(this.searchValue).then(function(e){200===e.data.resultCode&&0!==e.data.essays.length?(t.tableData1=[],e.data.essays.forEach(function(e){t.tableData1.push(e)})):400===e.data.resultCode?t.$Message.info(e.data.message):t.$Message.info("该角色名称不存在")})}},created:function(){var t=this;r(10,1).then(function(e){var a=e.data.page;"200"===e.data.resultCode?(a.list.forEach(function(e){t.tableData1.push(e)}),t.total=a.total,t.currentPage=a.pageNum):400===e.data.resultCode&&t.$Message.info(e.data.message)}),Object(d["a"])().then(function(e){var a=e.menuList;a.forEach(function(e){t.menuList.push({key:e.menu_id,label:e.label})})})}},h=m,f=(a("508f"),a("2877")),g=Object(f["a"])(h,n,s,!1,null,null,null);g.options.__file="roleManager.vue";e["default"]=g.exports},3418:function(t,e,a){},"508f":function(t,e,a){"use strict";var n=a("3418"),s=a.n(n);s.a}}]);